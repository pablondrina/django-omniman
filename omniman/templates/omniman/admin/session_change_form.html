{% extends "admin/change_form.html" %}
{% load i18n %}

{% block after_field_sets %}
{{ block.super }}

{% if issue_actions %}
<div class="module" style="margin-top: 20px;">
    <h2>{% trans "Problemas Pendentes" %}</h2>
    <div style="padding: 10px;">
        {% for issue in issue_actions %}
        <div class="{% if issue.blocking %}bg-danger-50 border-danger-200{% else %}bg-warning-50 border-warning-200{% endif %} border rounded p-3 mb-2">
            <strong>{{ issue.code }}</strong>
            {% if issue.blocking %}<span class="badge bg-danger text-white ml-2">{% trans "Bloqueante" %}</span>{% endif %}
            <p class="text-sm text-secondary mt-1">{{ issue.message }}</p>
            {% if issue.actions %}
            <div class="mt-2">
                {% for action in issue.actions %}
                <a href="{% url 'admin:omniman_session_resolve_issue' object_id=original.pk issue_id=issue.id action_id=action.id %}" 
                   class="btn btn-sm btn-outline-primary mr-1">
                    {{ action.label }}
                </a>
                {% endfor %}
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

{% if manual_checks %}
<div class="module" style="margin-top: 20px;">
    <h2>{% trans "Verificações Manuais" %}</h2>
    <div style="padding: 10px;">
        {% for check in manual_checks %}
        <a href="{% url 'admin:omniman_session_run_check' object_id=original.pk topic=check.topic %}" 
           class="btn btn-outline-secondary mr-2">
            {% trans "Executar" %}: {{ check.label }}
        </a>
        {% endfor %}
    </div>
</div>
{% endif %}

{% endblock %}
